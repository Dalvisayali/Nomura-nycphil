[2024-07-19T06:26:47.507+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: sandbox.Preprocess_data manual__2024-07-19T06:26:44.811550+00:00 [queued]>
[2024-07-19T06:26:47.513+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: sandbox.Preprocess_data manual__2024-07-19T06:26:44.811550+00:00 [queued]>
[2024-07-19T06:26:47.513+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-07-19T06:26:47.519+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): Preprocess_data> on 2024-07-19 06:26:44.811550+00:00
[2024-07-19T06:26:47.523+0000] {standard_task_runner.py:60} INFO - Started process 117 to run task
[2024-07-19T06:26:47.529+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'sandbox', 'Preprocess_data', 'manual__2024-07-19T06:26:44.811550+00:00', '--job-id', '64', '--raw', '--subdir', 'DAGS_FOLDER/sandbox.py', '--cfg-path', '/tmp/tmp5bh0slgn']
[2024-07-19T06:26:47.532+0000] {standard_task_runner.py:88} INFO - Job 64: Subtask Preprocess_data
[2024-07-19T06:26:47.573+0000] {task_command.py:423} INFO - Running <TaskInstance: sandbox.Preprocess_data manual__2024-07-19T06:26:44.811550+00:00 [running]> on host c68e1ebf79ab
[2024-07-19T06:26:47.833+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='sandbox' AIRFLOW_CTX_TASK_ID='Preprocess_data' AIRFLOW_CTX_EXECUTION_DATE='2024-07-19T06:26:44.811550+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-07-19T06:26:44.811550+00:00'
[2024-07-19T06:26:47.835+0000] {logging_mixin.py:188} INFO - START!!!!!!!!!!
[2024-07-19T06:26:47.836+0000] {logging_mixin.py:188} INFO - 
==================================================
[2024-07-19T06:26:47.836+0000] {logging_mixin.py:188} INFO - 
STEP 1: LOADING JSON DATA
[2024-07-19T06:26:48.627+0000] {logging_mixin.py:188} INFO - 
==================================================
[2024-07-19T06:26:48.628+0000] {logging_mixin.py:188} INFO - 
STEP 2: NORMALIZING JSON DATA INTO DATAFRAMES
[2024-07-19T06:26:49.722+0000] {logging_mixin.py:188} INFO - DataFrame: nycphil
[2024-07-19T06:26:49.723+0000] {logging_mixin.py:188} INFO - Number of Rows: 13954
[2024-07-19T06:26:49.724+0000] {logging_mixin.py:188} INFO - Number of Columns: 6
[2024-07-19T06:26:49.724+0000] {logging_mixin.py:188} INFO - Column Names:
[2024-07-19T06:26:49.725+0000] {logging_mixin.py:188} INFO -  - season
[2024-07-19T06:26:49.725+0000] {logging_mixin.py:188} INFO -  - orchestra
[2024-07-19T06:26:49.726+0000] {logging_mixin.py:188} INFO -  - concerts
[2024-07-19T06:26:49.726+0000] {logging_mixin.py:188} INFO -  - programID
[2024-07-19T06:26:49.727+0000] {logging_mixin.py:188} INFO -  - works
[2024-07-19T06:26:49.727+0000] {logging_mixin.py:188} INFO -  - id
[2024-07-19T06:26:49.728+0000] {logging_mixin.py:188} INFO - 
--------------------------------------------------
[2024-07-19T06:26:49.728+0000] {logging_mixin.py:188} INFO - DataFrame: concerts_df
[2024-07-19T06:26:49.728+0000] {logging_mixin.py:188} INFO - Number of Rows: 21607
[2024-07-19T06:26:49.729+0000] {logging_mixin.py:188} INFO - Number of Columns: 9
[2024-07-19T06:26:49.729+0000] {logging_mixin.py:188} INFO - Column Names:
[2024-07-19T06:26:49.730+0000] {logging_mixin.py:188} INFO -  - concert_Date
[2024-07-19T06:26:49.730+0000] {logging_mixin.py:188} INFO -  - concert_eventType
[2024-07-19T06:26:49.730+0000] {logging_mixin.py:188} INFO -  - concert_Venue
[2024-07-19T06:26:49.731+0000] {logging_mixin.py:188} INFO -  - concert_Location
[2024-07-19T06:26:49.731+0000] {logging_mixin.py:188} INFO -  - concert_Time
[2024-07-19T06:26:49.732+0000] {logging_mixin.py:188} INFO -  - season
[2024-07-19T06:26:49.732+0000] {logging_mixin.py:188} INFO -  - orchestra
[2024-07-19T06:26:49.732+0000] {logging_mixin.py:188} INFO -  - programID
[2024-07-19T06:26:49.733+0000] {logging_mixin.py:188} INFO -  - id
[2024-07-19T06:26:49.733+0000] {logging_mixin.py:188} INFO - 
--------------------------------------------------
[2024-07-19T06:26:49.734+0000] {logging_mixin.py:188} INFO - DataFrame: works_df
[2024-07-19T06:26:49.735+0000] {logging_mixin.py:188} INFO - Number of Rows: 82793
[2024-07-19T06:26:49.735+0000] {logging_mixin.py:188} INFO - Number of Columns: 15
[2024-07-19T06:26:49.735+0000] {logging_mixin.py:188} INFO - Column Names:
[2024-07-19T06:26:49.736+0000] {logging_mixin.py:188} INFO -  - work_workTitle
[2024-07-19T06:26:49.736+0000] {logging_mixin.py:188} INFO -  - work_conductorName
[2024-07-19T06:26:49.736+0000] {logging_mixin.py:188} INFO -  - work_ID
[2024-07-19T06:26:49.737+0000] {logging_mixin.py:188} INFO -  - work_soloists
[2024-07-19T06:26:49.737+0000] {logging_mixin.py:188} INFO -  - work_composerName
[2024-07-19T06:26:49.738+0000] {logging_mixin.py:188} INFO -  - work_movement
[2024-07-19T06:26:49.738+0000] {logging_mixin.py:188} INFO -  - work_interval
[2024-07-19T06:26:49.738+0000] {logging_mixin.py:188} INFO -  - work_movement.em
[2024-07-19T06:26:49.739+0000] {logging_mixin.py:188} INFO -  - work_movement._
[2024-07-19T06:26:49.739+0000] {logging_mixin.py:188} INFO -  - work_workTitle.em
[2024-07-19T06:26:49.739+0000] {logging_mixin.py:188} INFO -  - work_workTitle._
[2024-07-19T06:26:49.740+0000] {logging_mixin.py:188} INFO -  - season
[2024-07-19T06:26:49.740+0000] {logging_mixin.py:188} INFO -  - orchestra
[2024-07-19T06:26:49.741+0000] {logging_mixin.py:188} INFO -  - programID
[2024-07-19T06:26:49.741+0000] {logging_mixin.py:188} INFO -  - id
[2024-07-19T06:26:49.742+0000] {logging_mixin.py:188} INFO - 
--------------------------------------------------
[2024-07-19T06:26:49.742+0000] {logging_mixin.py:188} INFO - DataFrame: soloists_df
[2024-07-19T06:26:49.743+0000] {logging_mixin.py:188} INFO - Number of Rows: 56194
[2024-07-19T06:26:49.743+0000] {logging_mixin.py:188} INFO - Number of Columns: 7
[2024-07-19T06:26:49.744+0000] {logging_mixin.py:188} INFO - Column Names:
[2024-07-19T06:26:49.744+0000] {logging_mixin.py:188} INFO -  - soloist_soloistName
[2024-07-19T06:26:49.744+0000] {logging_mixin.py:188} INFO -  - soloist_soloistRoles
[2024-07-19T06:26:49.745+0000] {logging_mixin.py:188} INFO -  - soloist_soloistInstrument
[2024-07-19T06:26:49.745+0000] {logging_mixin.py:188} INFO -  - season
[2024-07-19T06:26:49.746+0000] {logging_mixin.py:188} INFO -  - orchestra
[2024-07-19T06:26:49.746+0000] {logging_mixin.py:188} INFO -  - programID
[2024-07-19T06:26:49.746+0000] {logging_mixin.py:188} INFO -  - id
[2024-07-19T06:26:49.747+0000] {logging_mixin.py:188} INFO - 
--------------------------------------------------
[2024-07-19T06:26:49.747+0000] {logging_mixin.py:188} INFO - 
==================================================
[2024-07-19T06:26:49.748+0000] {logging_mixin.py:188} INFO - 
STEP 3: DATA EXPLORATION
[2024-07-19T06:26:49.748+0000] {logging_mixin.py:188} INFO - Checking the null percentage of each column in all dfs...
[2024-07-19T06:26:49.825+0000] {logging_mixin.py:188} INFO - {'nycphil': season       0.0
orchestra    0.0
concerts     0.0
programID    0.0
works        0.0
id           0.0
dtype: float64, 'concerts_df': concert_Date         0.0
concert_eventType    0.0
concert_Venue        0.0
concert_Location     0.0
concert_Time         0.0
season               0.0
orchestra            0.0
programID            0.0
id                   0.0
dtype: float64, 'works_df': work_workTitle        13.734253
work_conductorName    19.903857
work_ID                0.000000
work_soloists          0.000000
work_composerName     13.728214
work_movement         69.817497
work_interval         86.271786
work_movement.em      99.725822
work_movement._       99.862307
work_workTitle.em     99.993961
work_workTitle._      99.993961
season                 0.000000
orchestra              0.000000
programID              0.000000
id                     0.000000
dtype: float64, 'soloists_df': soloist_soloistName          0.0
soloist_soloistRoles         0.0
soloist_soloistInstrument    0.0
season                       0.0
orchestra                    0.0
programID                    0.0
id                           0.0
dtype: float64}
[2024-07-19T06:26:49.826+0000] {logging_mixin.py:188} INFO - Dropping columns with null % > 80...
[2024-07-19T06:26:49.846+0000] {logging_mixin.py:188} INFO - 
==================================================
[2024-07-19T06:26:49.847+0000] {logging_mixin.py:188} INFO - 
STEP 4: DATA CLEANING
[2024-07-19T06:26:49.848+0000] {logging_mixin.py:188} INFO - Replacing nulls with 'Unknown' value and converting into correct data types...
[2024-07-19T06:26:49.930+0000] {logging_mixin.py:188} INFO - DataFrame: nycphil
[2024-07-19T06:26:49.931+0000] {logging_mixin.py:188} INFO - Number of Rows: 13954
[2024-07-19T06:26:49.931+0000] {logging_mixin.py:188} INFO - Number of Columns: 6
[2024-07-19T06:26:49.932+0000] {logging_mixin.py:188} INFO - Column Names:
[2024-07-19T06:26:49.932+0000] {logging_mixin.py:188} INFO -  - season
[2024-07-19T06:26:49.933+0000] {logging_mixin.py:188} INFO -  - orchestra
[2024-07-19T06:26:49.933+0000] {logging_mixin.py:188} INFO -  - concerts
[2024-07-19T06:26:49.933+0000] {logging_mixin.py:188} INFO -  - programID
[2024-07-19T06:26:49.934+0000] {logging_mixin.py:188} INFO -  - works
[2024-07-19T06:26:49.934+0000] {logging_mixin.py:188} INFO -  - id
[2024-07-19T06:26:49.934+0000] {logging_mixin.py:188} INFO - 
--------------------------------------------------
[2024-07-19T06:26:49.935+0000] {logging_mixin.py:188} INFO - DataFrame: concerts_df
[2024-07-19T06:26:49.935+0000] {logging_mixin.py:188} INFO - Number of Rows: 21607
[2024-07-19T06:26:49.936+0000] {logging_mixin.py:188} INFO - Number of Columns: 9
[2024-07-19T06:26:49.936+0000] {logging_mixin.py:188} INFO - Column Names:
[2024-07-19T06:26:49.937+0000] {logging_mixin.py:188} INFO -  - concert_Date
[2024-07-19T06:26:49.937+0000] {logging_mixin.py:188} INFO -  - concert_eventType
[2024-07-19T06:26:49.937+0000] {logging_mixin.py:188} INFO -  - concert_Venue
[2024-07-19T06:26:49.938+0000] {logging_mixin.py:188} INFO -  - concert_Location
[2024-07-19T06:26:49.938+0000] {logging_mixin.py:188} INFO -  - concert_Time
[2024-07-19T06:26:49.939+0000] {logging_mixin.py:188} INFO -  - season
[2024-07-19T06:26:49.939+0000] {logging_mixin.py:188} INFO -  - orchestra
[2024-07-19T06:26:49.939+0000] {logging_mixin.py:188} INFO -  - programID
[2024-07-19T06:26:49.940+0000] {logging_mixin.py:188} INFO -  - id
[2024-07-19T06:26:49.940+0000] {logging_mixin.py:188} INFO - 
--------------------------------------------------
[2024-07-19T06:26:49.940+0000] {logging_mixin.py:188} INFO - DataFrame: works_df
[2024-07-19T06:26:49.941+0000] {logging_mixin.py:188} INFO - Number of Rows: 82793
[2024-07-19T06:26:49.941+0000] {logging_mixin.py:188} INFO - Number of Columns: 10
[2024-07-19T06:26:49.941+0000] {logging_mixin.py:188} INFO - Column Names:
[2024-07-19T06:26:49.942+0000] {logging_mixin.py:188} INFO -  - work_workTitle
[2024-07-19T06:26:49.942+0000] {logging_mixin.py:188} INFO -  - work_conductorName
[2024-07-19T06:26:49.943+0000] {logging_mixin.py:188} INFO -  - work_ID
[2024-07-19T06:26:49.943+0000] {logging_mixin.py:188} INFO -  - work_soloists
[2024-07-19T06:26:49.943+0000] {logging_mixin.py:188} INFO -  - work_composerName
[2024-07-19T06:26:49.944+0000] {logging_mixin.py:188} INFO -  - work_movement
[2024-07-19T06:26:49.944+0000] {logging_mixin.py:188} INFO -  - season
[2024-07-19T06:26:49.944+0000] {logging_mixin.py:188} INFO -  - orchestra
[2024-07-19T06:26:49.945+0000] {logging_mixin.py:188} INFO -  - programID
[2024-07-19T06:26:49.945+0000] {logging_mixin.py:188} INFO -  - id
[2024-07-19T06:26:49.945+0000] {logging_mixin.py:188} INFO - 
--------------------------------------------------
[2024-07-19T06:26:49.946+0000] {logging_mixin.py:188} INFO - DataFrame: soloists_df
[2024-07-19T06:26:49.946+0000] {logging_mixin.py:188} INFO - Number of Rows: 56194
[2024-07-19T06:26:49.947+0000] {logging_mixin.py:188} INFO - Number of Columns: 7
[2024-07-19T06:26:49.947+0000] {logging_mixin.py:188} INFO - Column Names:
[2024-07-19T06:26:49.947+0000] {logging_mixin.py:188} INFO -  - soloist_soloistName
[2024-07-19T06:26:49.948+0000] {logging_mixin.py:188} INFO -  - soloist_soloistRoles
[2024-07-19T06:26:49.948+0000] {logging_mixin.py:188} INFO -  - soloist_soloistInstrument
[2024-07-19T06:26:49.949+0000] {logging_mixin.py:188} INFO -  - season
[2024-07-19T06:26:49.949+0000] {logging_mixin.py:188} INFO -  - orchestra
[2024-07-19T06:26:49.949+0000] {logging_mixin.py:188} INFO -  - programID
[2024-07-19T06:26:49.950+0000] {logging_mixin.py:188} INFO -  - id
[2024-07-19T06:26:49.950+0000] {logging_mixin.py:188} INFO - 
--------------------------------------------------
[2024-07-19T06:26:50.237+0000] {connection.py:386} INFO - Snowflake Connector for Python Version: 3.7.1, Python Version: 3.8.18, Platform: Linux-5.15.49-linuxkit-pr-aarch64-with-glibc2.34
[2024-07-19T06:26:50.237+0000] {connection.py:1211} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2024-07-19T06:26:50.961+0000] {cursor.py:1032} INFO - query: [select current_database(), current_schema();]
[2024-07-19T06:26:51.040+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:26:51.046+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-07-19T06:26:51.054+0000] {cursor.py:1032} INFO - query: [ROLLBACK]
[2024-07-19T06:26:51.144+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:26:51.145+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-07-19T06:26:51.145+0000] {cursor.py:1032} INFO - query: [select current_version()]
[2024-07-19T06:26:51.227+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:26:51.229+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-07-19T06:26:51.230+0000] {logging_mixin.py:188} INFO - 8.26.0
[2024-07-19T06:26:51.230+0000] {cursor.py:1032} INFO - query: [USE DATABASE NYCPHIL_DB]
[2024-07-19T06:26:51.293+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:26:51.294+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-07-19T06:26:51.295+0000] {cursor.py:1032} INFO - query: [USE SCHEMA PUBLIC]
[2024-07-19T06:26:51.361+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:26:51.362+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-07-19T06:26:51.364+0000] {cursor.py:1032} INFO - query: [DESC TABLE /* sqlalchemy:_has_object */ nycphil]
[2024-07-19T06:26:51.428+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:26:51.443+0000] {cursor.py:1032} INFO - query: [ROLLBACK]
[2024-07-19T06:26:51.520+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:26:51.521+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-07-19T06:26:51.521+0000] {cursor.py:1032} INFO - query: [DESC TABLE /* sqlalchemy:_has_object */ concerts]
[2024-07-19T06:26:51.623+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:26:51.625+0000] {cursor.py:1032} INFO - query: [ROLLBACK]
[2024-07-19T06:26:51.697+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:26:51.700+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-07-19T06:26:51.703+0000] {cursor.py:1032} INFO - query: [DESC TABLE /* sqlalchemy:_has_object */ works]
[2024-07-19T06:26:51.772+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:26:51.777+0000] {cursor.py:1032} INFO - query: [ROLLBACK]
[2024-07-19T06:26:51.833+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:26:51.834+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-07-19T06:26:51.836+0000] {cursor.py:1032} INFO - query: [DESC TABLE /* sqlalchemy:_has_object */ soloists]
[2024-07-19T06:26:51.918+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:26:51.922+0000] {cursor.py:1032} INFO - query: [ROLLBACK]
[2024-07-19T06:26:52.019+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:26:52.022+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-07-19T06:26:52.025+0000] {cursor.py:1032} INFO - query: [CREATE TABLE nycphil ( id VARCHAR NOT NULL, season VARCHAR, orchestra VARCHAR, p...]
[2024-07-19T06:26:52.175+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:26:52.180+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-07-19T06:26:52.184+0000] {cursor.py:1032} INFO - query: [CREATE TABLE concerts ( concert_id INTEGER NOT NULL  IDENTITY(1,1), concert_date...]
[2024-07-19T06:26:52.358+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:26:52.363+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-07-19T06:26:52.366+0000] {cursor.py:1032} INFO - query: [CREATE TABLE works ( work_id INTEGER NOT NULL  IDENTITY(1,1), work_work_title VA...]
[2024-07-19T06:26:52.578+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:26:52.581+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-07-19T06:26:52.583+0000] {cursor.py:1032} INFO - query: [CREATE TABLE soloists ( soloist_id INTEGER NOT NULL  IDENTITY(1,1), soloist_name...]
[2024-07-19T06:26:52.801+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:26:52.805+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-07-19T06:26:52.877+0000] {logging_mixin.py:188} INFO - Exported nycphil to cleaned_data/nycphil.csv
[2024-07-19T06:26:52.958+0000] {logging_mixin.py:188} INFO - Exported concerts to cleaned_data/concerts.csv
[2024-07-19T06:26:53.079+0000] {logging_mixin.py:188} INFO - Exported works to cleaned_data/works.csv
[2024-07-19T06:26:53.134+0000] {logging_mixin.py:188} INFO - Exported soloists to cleaned_data/soloists.csv
[2024-07-19T06:26:53.134+0000] {logging_mixin.py:188} INFO - Creating stage nycphil...
[2024-07-19T06:26:53.135+0000] {logging_mixin.py:188} INFO - CREATE OR REPLACE STAGE nycphil DIRECTORY = ( ENABLE = true ) FILE_FORMAT = (TYPE = 'CSV' field_optionally_enclosed_by='"' SKIP_HEADER = 1);
[2024-07-19T06:26:53.136+0000] {cursor.py:1032} INFO - query: [CREATE OR REPLACE STAGE nycphil DIRECTORY = ( ENABLE = true ) FILE_FORMAT = (TYP...]
[2024-07-19T06:26:53.535+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:26:53.537+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-07-19T06:26:53.538+0000] {logging_mixin.py:188} INFO - Done
[2024-07-19T06:26:53.538+0000] {logging_mixin.py:188} INFO - Uploading cleaned_data/nycphil.csv to stage nycphil...
[2024-07-19T06:26:53.539+0000] {logging_mixin.py:188} INFO - PUT file://cleaned_data/nycphil.csv @NYCPHIL_DB.public.nycphil;
[2024-07-19T06:26:53.540+0000] {cursor.py:1032} INFO - query: [PUT file://cleaned_data/nycphil.csv @NYCPHIL_DB.public.nycphil;]
[2024-07-19T06:26:53.698+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:26:54.379+0000] {logging_mixin.py:188} INFO - Done
[2024-07-19T06:26:54.381+0000] {logging_mixin.py:188} INFO - Loading data from nycphil.csv to table nycphil...
[2024-07-19T06:26:54.381+0000] {logging_mixin.py:188} INFO - COPY INTO nycphil (id, season, orchestra, program_id)
            FROM @NYCPHIL_DB.public.nycphil
            FILE_FORMAT = (type = csv field_optionally_enclosed_by='"' SKIP_HEADER = 1)
            
[2024-07-19T06:26:54.382+0000] {cursor.py:1032} INFO - query: [COPY INTO nycphil (id, season, orchestra, program_id) FROM @NYCPHIL_DB.public.ny...]
[2024-07-19T06:26:55.891+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:26:55.892+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-07-19T06:26:55.893+0000] {cursor.py:1032} INFO - query: [COMMIT]
[2024-07-19T06:26:56.093+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:26:56.095+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-07-19T06:26:56.096+0000] {logging_mixin.py:188} INFO - Done
[2024-07-19T06:26:56.096+0000] {logging_mixin.py:188} INFO - Creating stage soloists...
[2024-07-19T06:26:56.097+0000] {logging_mixin.py:188} INFO - CREATE OR REPLACE STAGE soloists DIRECTORY = ( ENABLE = true ) FILE_FORMAT = (TYPE = 'CSV' field_optionally_enclosed_by='"' SKIP_HEADER = 1);
[2024-07-19T06:26:56.098+0000] {cursor.py:1032} INFO - query: [CREATE OR REPLACE STAGE soloists DIRECTORY = ( ENABLE = true ) FILE_FORMAT = (TY...]
[2024-07-19T06:26:56.507+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:26:56.511+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-07-19T06:26:56.513+0000] {logging_mixin.py:188} INFO - Done
[2024-07-19T06:26:56.515+0000] {logging_mixin.py:188} INFO - Uploading cleaned_data/soloists.csv to stage soloists...
[2024-07-19T06:26:56.516+0000] {logging_mixin.py:188} INFO - PUT file://cleaned_data/soloists.csv @NYCPHIL_DB.public.soloists;
[2024-07-19T06:26:56.517+0000] {cursor.py:1032} INFO - query: [PUT file://cleaned_data/soloists.csv @NYCPHIL_DB.public.soloists;]
[2024-07-19T06:26:56.709+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:26:57.011+0000] {logging_mixin.py:188} INFO - Done
[2024-07-19T06:26:57.012+0000] {logging_mixin.py:188} INFO - Loading data from soloists.csv to table soloists...
[2024-07-19T06:26:57.013+0000] {logging_mixin.py:188} INFO - COPY INTO soloists (soloist_name, soloist_roles, soloist_instrument)
            FROM @NYCPHIL_DB.public.soloists
            FILE_FORMAT = (type = csv field_optionally_enclosed_by='"' SKIP_HEADER = 1)
            
[2024-07-19T06:26:57.015+0000] {cursor.py:1032} INFO - query: [COPY INTO soloists (soloist_name, soloist_roles, soloist_instrument) FROM @NYCPH...]
[2024-07-19T06:26:58.861+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:26:58.865+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-07-19T06:26:58.867+0000] {cursor.py:1032} INFO - query: [COMMIT]
[2024-07-19T06:26:59.035+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:26:59.038+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-07-19T06:26:59.040+0000] {logging_mixin.py:188} INFO - Done
[2024-07-19T06:26:59.041+0000] {logging_mixin.py:188} INFO - Creating stage works...
[2024-07-19T06:26:59.043+0000] {logging_mixin.py:188} INFO - CREATE OR REPLACE STAGE works DIRECTORY = ( ENABLE = true ) FILE_FORMAT = (TYPE = 'CSV' field_optionally_enclosed_by='"' SKIP_HEADER = 1);
[2024-07-19T06:26:59.045+0000] {cursor.py:1032} INFO - query: [CREATE OR REPLACE STAGE works DIRECTORY = ( ENABLE = true ) FILE_FORMAT = (TYPE ...]
[2024-07-19T06:26:59.371+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:26:59.374+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-07-19T06:26:59.375+0000] {logging_mixin.py:188} INFO - Done
[2024-07-19T06:26:59.377+0000] {logging_mixin.py:188} INFO - Uploading cleaned_data/works.csv to stage works...
[2024-07-19T06:26:59.377+0000] {logging_mixin.py:188} INFO - PUT file://cleaned_data/works.csv @NYCPHIL_DB.public.works;
[2024-07-19T06:26:59.379+0000] {cursor.py:1032} INFO - query: [PUT file://cleaned_data/works.csv @NYCPHIL_DB.public.works;]
[2024-07-19T06:26:59.577+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:27:00.185+0000] {logging_mixin.py:188} INFO - Done
[2024-07-19T06:27:00.188+0000] {logging_mixin.py:188} INFO - Loading data from works.csv to table works...
[2024-07-19T06:27:00.190+0000] {logging_mixin.py:188} INFO - COPY INTO works (work_work_title, work_conductor_name, work_composer_name, work_movement, nycphil_id)
            FROM @NYCPHIL_DB.public.works
            FILE_FORMAT = (type = csv field_optionally_enclosed_by='"' SKIP_HEADER = 1)
            
[2024-07-19T06:27:00.192+0000] {cursor.py:1032} INFO - query: [COPY INTO works (work_work_title, work_conductor_name, work_composer_name, work_...]
[2024-07-19T06:27:01.525+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:27:01.529+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-07-19T06:27:01.531+0000] {cursor.py:1032} INFO - query: [COMMIT]
[2024-07-19T06:27:01.733+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:27:01.734+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-07-19T06:27:01.735+0000] {logging_mixin.py:188} INFO - Done
[2024-07-19T06:27:01.737+0000] {logging_mixin.py:188} INFO - Creating stage concerts...
[2024-07-19T06:27:01.738+0000] {logging_mixin.py:188} INFO - CREATE OR REPLACE STAGE concerts DIRECTORY = ( ENABLE = true ) FILE_FORMAT = (TYPE = 'CSV' field_optionally_enclosed_by='"' SKIP_HEADER = 1);
[2024-07-19T06:27:01.739+0000] {cursor.py:1032} INFO - query: [CREATE OR REPLACE STAGE concerts DIRECTORY = ( ENABLE = true ) FILE_FORMAT = (TY...]
[2024-07-19T06:27:02.139+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:27:02.143+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-07-19T06:27:02.147+0000] {logging_mixin.py:188} INFO - Done
[2024-07-19T06:27:02.149+0000] {logging_mixin.py:188} INFO - Uploading cleaned_data/concerts.csv to stage concerts...
[2024-07-19T06:27:02.152+0000] {logging_mixin.py:188} INFO - PUT file://cleaned_data/concerts.csv @NYCPHIL_DB.public.concerts;
[2024-07-19T06:27:02.155+0000] {cursor.py:1032} INFO - query: [PUT file://cleaned_data/concerts.csv @NYCPHIL_DB.public.concerts;]
[2024-07-19T06:27:02.448+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:27:02.854+0000] {logging_mixin.py:188} INFO - Done
[2024-07-19T06:27:02.856+0000] {logging_mixin.py:188} INFO - Loading data from concerts.csv to table concerts...
[2024-07-19T06:27:02.856+0000] {logging_mixin.py:188} INFO - COPY INTO concerts (concert_date, concert_event_type, concert_venue, concert_location, concert_time, nycphil_id)
            FROM @NYCPHIL_DB.public.concerts
            FILE_FORMAT = (type = csv field_optionally_enclosed_by='"' SKIP_HEADER = 1)
            
[2024-07-19T06:27:02.857+0000] {cursor.py:1032} INFO - query: [COPY INTO concerts (concert_date, concert_event_type, concert_venue, concert_loc...]
[2024-07-19T06:27:05.415+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:27:05.418+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-07-19T06:27:05.421+0000] {cursor.py:1032} INFO - query: [COMMIT]
[2024-07-19T06:27:05.816+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:27:05.819+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-07-19T06:27:05.821+0000] {logging_mixin.py:188} INFO - Done
[2024-07-19T06:27:05.822+0000] {logging_mixin.py:188} INFO - DONE!!!!!!!!!!
[2024-07-19T06:27:05.955+0000] {cursor.py:1032} INFO - query: [ROLLBACK]
[2024-07-19T06:27:06.012+0000] {cursor.py:1045} INFO - query execution done
[2024-07-19T06:27:06.012+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-07-19T06:27:06.020+0000] {python.py:202} INFO - Done. Returned value was: None
[2024-07-19T06:27:06.034+0000] {taskinstance.py:1149} INFO - Marking task as SUCCESS. dag_id=sandbox, task_id=Preprocess_data, execution_date=20240719T062644, start_date=20240719T062647, end_date=20240719T062706
[2024-07-19T06:27:06.193+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2024-07-19T06:27:06.208+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
